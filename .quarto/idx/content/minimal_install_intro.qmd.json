{"title":"Manual Arch Linux Installation","markdown":{"headingText":"Manual Arch Linux Installation","containsRefs":false,"markdown":"\n## Introduction\n\nThis chapter documents a manual Arch Linux installation process. Unlike automated installers, this approach requires understanding each component of the system. The goal is to build knowledge incrementally, creating a foundation for deeper Linux expertise.\n\nThe installation follows the Arch philosophy: simplicity, user control, and transparency. By the end, you'll have a minimal, command-line system ready for customization.\n\n## Pre-Installation Checks\n\nBefore installing, verify that the live environment is configured correctly.\n\n### Verify Boot Mode\n\n```bash\nls /sys/firmware/efi/efivars\n```\n\n**What this does:** Checks if the system booted in UEFI mode. If the directory exists and contains files, you're in UEFI mode. This is important because the bootloader installation later depends on the boot mode.\n\n**Why it matters:** Modern systems use UEFI instead of legacy BIOS. UEFI provides better security features and faster boot times. The presence of `efivars` confirms the firmware interface is accessible.\n\n### Verify Network Connectivity\n\n```bash\nping archlinux.org\n```\n\n**What this does:** Sends network packets to verify internet connectivity. Press `Ctrl+C` to stop.\n\n**Why it matters:** The installation requires downloading packages from remote repositories. The live environment typically configures networking automatically via DHCP, but it's essential to verify before proceeding.\n\n### Update System Clock\n\n```bash\ntimedatectl set-ntp true\n```\n\n**What this does:** Enables Network Time Protocol (NTP) synchronization, ensuring the system clock is accurate.\n\n**Why it matters:** Accurate timestamps are crucial for package management, encryption, and system logs. Many security protocols depend on synchronized time.\n\n## Disk Partitioning and Preparation\n\nThis section creates the disk structure: an EFI partition for the bootloader, a swap partition for memory overflow, and a Btrfs partition for the root filesystem.\n\n### Understanding the Layout\n\n- **EFI Partition (512MB):** Stores bootloader files. Must be FAT32 format.\n- **Swap Partition (2GB):** Acts as overflow when RAM is full. Size typically matches RAM for systems with ≤8GB.\n- **Root Partition (Remaining):** Contains the entire Linux system using Btrfs filesystem.\n\n### Partition the Disk\n\n```bash\ncfdisk /dev/sda\n```\n\n**What this does:** Opens an interactive partition editor. The disk is typically `/dev/sda` in virtual machines.\n\n**Step-by-step:**\n\n1. Select **gpt** when prompted. GPT (GUID Partition Table) is required for UEFI and supports disks larger than 2TB.\n2. Create the EFI partition:\n   - Select **New** → Enter `512M`\n   - Navigate to **Type** → Select **EFI System**\n3. Create the swap partition:\n   - Select **New** → Enter `2G`\n   - Navigate to **Type** → Select **Linux swap**\n4. Create the root partition:\n   - Select **New** → Press Enter (uses remaining space)\n   - Type should default to **Linux filesystem**\n5. Select **Write** → Type `yes` → Select **Quit**\n\n**Why these choices:** GPT is modern and required for UEFI. The 512MB EFI partition provides ample space for multiple kernels. The 2GB swap allows basic memory management without wasting disk space.\n\n### Format the Partitions\n\nFormatting creates filesystems on the raw partitions, making them usable by the operating system.\n\n```bash\nmkfs.fat -F32 /dev/sda1         # EFI partition\nmkswap /dev/sda2                # Swap partition\nswapon /dev/sda2                # Activate swap\nmkfs.btrfs -L ArchRoot /dev/sda3  # Root partition\n```\n\n**What each command does:**\n\n- `mkfs.fat -F32`: Creates a FAT32 filesystem (required for EFI).\n- `mkswap`: Prepares the partition for use as swap space.\n- `swapon`: Activates swap immediately for the installation process.\n- `mkfs.btrfs -L ArchRoot`: Creates a Btrfs filesystem with the label \"ArchRoot\".\n\n**Why Btrfs:** Btrfs offers advanced features like snapshots, compression, and subvolumes. Subvolumes allow separate management of different directory trees while sharing the same filesystem.\n\n### Create and Mount Btrfs Subvolumes\n\nSubvolumes provide flexibility for snapshots and separate management of system components.\n\n```bash\nmount /dev/sda3 /mnt\n```\n\n**What this does:** Temporarily mounts the Btrfs partition to create subvolumes.\n\n```bash\nbtrfs subvolume create /mnt/@\nbtrfs subvolume create /mnt/home\nbtrfs subvolume create /mnt/@pkg\n```\n\n**What this does:** Creates three subvolumes:\n\n- `@`: The root filesystem (follows Btrfs naming convention)\n- `home`: User home directories\n- `@pkg`: Package cache at `/var/cache/pacman/pkg`\n\n**Why separate subvolumes:** This allows independent snapshots of the root system without including user data or the package cache. You can restore the system without affecting personal files.\n\n### Remount with Optimizations\n\n```bash\numount /mnt\nmount -o compress=zstd,noatime,subvol=@ /dev/sda3 /mnt\n```\n\n**What this does:** Unmounts the filesystem, then remounts the root subvolume with specific options.\n\n**Mount options explained:**\n\n- `compress=zstd`: Enables transparent compression using Zstandard algorithm. Saves disk space and can improve performance on modern CPUs.\n- `noatime`: Disables recording file access times, reducing write operations and improving performance.\n- `subvol=@`: Mounts the root subvolume specifically.\n\n### Mount Remaining Subvolumes and EFI\n\n```bash\nmkdir -p /mnt/{boot/efi,home,var/cache/pacman/pkg}\nmount -o compress=zstd,noatime,subvol=home /dev/sda3 /mnt/home\nmount -o compress=zstd,noatime,subvol=@pkg /dev/sda3 /mnt/var/cache/pacman/pkg\nmount /dev/sda1 /mnt/boot/efi\n```\n\n**What this does:**\n\n1. Creates necessary directories under `/mnt`\n2. Mounts `home` subvolume to `/mnt/home`\n3. Mounts `@pkg` subvolume to the pacman cache location\n4. Mounts the EFI partition to `/mnt/boot/efi`\n\n**Verification:** Run `lsblk` to view the partition structure and confirm all mounts are correct.\n\n## Installing the Base System\n\n### Configure Package Mirrors\n\nBefore installing packages, it's beneficial to optimize the mirror list for faster downloads.\n\n```bash\nvim /etc/pacman.d/mirrorlist\n```\n\n**What this file contains:** A list of all available Arch Linux repository mirrors worldwide. The package manager (`pacman`) reads this file from top to bottom and uses the first working mirror it encounters.\n\n**Why mirror selection matters:** Geographically closer mirrors typically provide faster download speeds, reducing installation time and improving future system updates.\n\n#### Understanding Mirror Geography\n\nThe mirrorlist contains mirrors from various locations globally:\n\n- **Germany (DE)**: `de.arch.niran.jan.co`, `arch.phinau.de`, `berlin.mirror.pkgbuild.com`\n- **United States (US)**: `us.arch.mirror.constant.com`, `losangeles.mirror.pkgbuild.com`\n- **Singapore**: `singapore.mirror.pkgbuild.com`\n- **South Africa**: `johannesburg.mirror.pkgbuild.com`\n- **Europe (General)**: `mirror.xtom.ee`, `archlinux.tk-leaf.net`\n\n#### Prioritizing Your Nearest Mirrors\n\n**Steps to reorder mirrors:**\n\n1. In `vim`, navigate using arrow keys to locate mirrors closest to your location\n2. Position your cursor on the line of your preferred mirror\n3. Press `dd` to cut (delete) the entire line\n4. Move to the top of the list (below the comment headers)\n5. Press `p` to paste the line\n6. Repeat for additional nearby mirrors to create a prioritized list\n\n**Example for Germany:** You would move these mirrors to the top:\n```\nServer = https://de.arch.niran.jan.co/$repo/os/$arch\nServer = https://arch.phinau.de/$repo/os/$arch\nServer = https://berlin.mirror.pkgbuild.com/$repo/os/$arch\n```\n\n**Vim commands reference:**\n\nVim operates in different modes. Understanding this is key to using it effectively:\n\n- **Normal mode** (default): For navigation and commands\n  - `j`: Move down one line\n  - `k`: Move up one line\n  - Arrow keys: Also work for navigation (up, down, left, right)\n  - `dd`: Cut (delete) the current line\n  - `p`: Paste below the cursor\n- **Insert mode**: For typing text\n  - `i`: Enter insert mode (you'll see `-- INSERT --` at the bottom)\n  - In insert mode, `j` and `k` type the letters 'j' and 'k' instead of moving\n  - Arrow keys still work for navigation even in insert mode\n- **Command mode**: For saving and quitting\n  - `ESC`: Return to normal mode from any other mode\n  - `:wq`: Write (save) and quit\n  - `:q!`: Quit without saving (if you make a mistake)\n\n**Quick tip:** If you're unsure which mode you're in, press `ESC` to return to normal mode.\n\n**Saving and exiting:**\n\n1. Press `ESC` to ensure you're in normal mode\n2. Type `:wq` and press `Enter`\n\nThis prioritization ensures faster downloads throughout the installation and for future system updates.\n\n### Understanding pacstrap\n\nThe `pacstrap` script installs packages to a specified directory, creating the foundation of your Arch system.\n\n```bash\npacstrap /mnt base linux linux-firmware vim\n```\n\n**What this installs:**\n\n- `base`: Meta-package containing essential system utilities\n- `linux`: The Linux kernel\n- `linux-firmware`: Binary firmware files for common hardware\n- `vim`: Text editor (you can substitute with `nano` if preferred)\n\n**Why these packages:** The `base` package provides the bare minimum for a bootable system. The kernel is the operating system core. Firmware enables hardware like WiFi cards and graphics adapters. A text editor is essential for configuration.\n\n### Generate fstab\n\n```bash\ngenfstab -U /mnt >> /mnt/etc/fstab\n```\n\n**What this does:** Creates the `/etc/fstab` file, which defines how partitions and subvolumes mount at boot.\n\n**The `-U` flag:** Uses UUIDs (Universally Unique Identifiers) instead of device names. UUIDs remain consistent even if device naming changes, making the system more robust.\n\n## System Configuration\n\n### Enter the New System\n\n```bash\narch-chroot /mnt\n```\n\n**What this does:** Changes root into the new installation. This means you're now operating within the newly installed system rather than the live environment.\n\n**Why chroot:** This allows you to configure the system as if you had booted into it. All commands now affect the installed system, not the live USB.\n\n### Set Time Zone\n\n```bash\nln -sf /usr/share/zoneinfo/Region/City /etc/localtime\nhwclock --systohc\n```\n\n**What this does:**\n\n1. Creates a symbolic link from your timezone file to `/etc/localtime`\n2. Generates `/etc/adjtime` based on the current system time\n\n**Example:** For New York: `ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime`\n\n**Why this matters:** The timezone setting affects timestamps in logs, scheduled tasks, and user-facing time displays.\n\n### Configure Localization\n\nLocales define language, character encoding, and regional formatting.\n\n```bash\nvim /etc/locale.gen\n```\n\n**What to do:** Uncomment your locale(s). Most users will uncomment `en_US.UTF-8 UTF-8`.\n\n**Understanding UTF-8:** UTF-8 is a character encoding that supports international characters. It's the standard for modern Linux systems.\n\n```bash\nlocale-gen\necho \"LANG=en_US.UTF-8\" > /etc/locale.conf\n```\n\n**What this does:**\n\n1. Generates the locale files you uncommented\n2. Sets the system-wide default locale\n\n### Configure Networking\n\n```bash\necho \"your-hostname\" > /etc/hostname\n```\n\n**What this does:** Sets your computer's name on the network. Choose something memorable and unique.\n\n```bash\npacman -S networkmanager\nsystemctl enable NetworkManager\n```\n\n**What this does:**\n\n1. Installs NetworkManager, a program that handles network connections\n2. Enables the service to start automatically at boot\n\n**Why NetworkManager:** It provides automatic network configuration, WiFi management, and connection profiles. Essential for laptops and systems with multiple networks.\n\n### Set Root Password\n\n```bash\npasswd\n```\n\n**What this does:** Sets the password for the root (administrator) account.\n\n**Security note:** Choose a strong password. Root access allows complete system control.\n\n### Create User Account\n\n```bash\nuseradd -mG wheel -s /bin/bash yourusername\npasswd yourusername\n```\n\n**What this does:**\n\n1. Creates a new user with:\n   - `-m`: Creates a home directory\n   - `-G wheel`: Adds user to the `wheel` group (for sudo privileges)\n   - `-s /bin/bash`: Sets Bash as the default shell\n2. Sets the user's password\n\n**Why not use root:** Running as root constantly is dangerous. A regular user account with sudo provides security while maintaining administrative capabilities.\n\n### Configure sudo\n\n```bash\npacman -S sudo\nvisudo\n```\n\n**What this does:**\n\n1. Installs sudo (allows users to run commands as root)\n2. Opens the sudoers configuration file safely\n\n**In visudo:** Uncomment the line: `%wheel ALL=(ALL) ALL`\n\n**What this means:** Any user in the `wheel` group can run any command as any user by prefixing with `sudo`.\n\n## Bootloader Installation\n\nThe bootloader is what starts your operating system when the computer powers on.\n\n```bash\npacman -S grub efibootmgr\ngrub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=GRUB\ngrub-mkconfig -o /boot/grub/grub.cfg\n```\n\n**What each command does:**\n\n1. Installs GRUB (bootloader) and efibootmgr (manages EFI boot entries)\n2. Installs GRUB to the EFI partition:\n   - `--target=x86_64-efi`: Specifies UEFI mode for 64-bit systems\n   - `--efi-directory=/boot/efi`: Location of the EFI partition\n   - `--bootloader-id=GRUB`: Name shown in the firmware boot menu\n3. Generates GRUB configuration file (detects kernels and creates boot menu)\n\n### VM Tools (Virtual Machine Only)\n\n```bash\npacman -S open-vm-tools\nsystemctl enable vmtoolsd.service\n```\n\n**What this does:** Installs VMware integration tools for better mouse handling, clipboard sharing, and display resolution.\n\n**Skip this step** if installing on physical hardware.\n\n## Completing Installation\n\n### Exit and Reboot\n\n```bash\nexit\numount -R /mnt\nreboot\n```\n\n**What this does:**\n\n1. Exits the chroot environment\n2. Recursively unmounts all filesystems under `/mnt`\n3. Reboots the system\n\n**Critical:** Before the system restarts, remove the installation ISO from your VM settings (or physical USB drive). The system should now boot from the hard disk.\n\n## First Boot\n\nAfter rebooting, you'll see a login prompt. Log in with your username and password.\n\n**You now have:** A minimal, command-line Arch Linux system. No graphical interface yet—just a terminal.\n\n## Next Steps\n\nTo create a usable desktop environment, you'll need to install:\n\n1. **Display Server** (`xorg-server`): Manages graphics output\n2. **Window Manager** (e.g., `i3`, `dwm`): Controls window placement and behavior\n3. **Terminal Emulator** (e.g., `alacritty`): Provides terminal access in the GUI\n4. **Display Manager** (e.g., `lightdm`): Provides graphical login\n\nThese will be covered in subsequent chapters as you continue building your customized system.\n\n## Key Takeaways\n\n- Manual installation teaches system architecture by requiring interaction with each component\n- Btrfs subvolumes enable flexible snapshot management\n- Proper partitioning separates bootloader, swap, and system data\n- The chroot environment allows system configuration before first boot\n- Starting minimal allows you to understand each layer you add\n\nThis foundation provides complete control over your Linux system and prepares you for advanced customization.","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"minimal_install_intro.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.28","theme":"flatly","csl":"https://raw.githubusercontent.com/citation-style-language/styles/master/ieee.csl"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}